<?php

function sef($str)
{
    $str = mb_convert_encoding((string)$str, 'UTF-8', mb_list_encodings());
    $defaults = array(
        'delimiter'=>'-',
        'limit' => null,
        'lowercase'=>true,
        'replacements'=>array(),
        'transliterate'=>true
    );
    $options = array_merge($defaults);
    $char_map= array(
        //Latin
        $table = array(
            'À'=>'A', 'Á'=>'A', 'Â'=>'A', 'Ã'=>'A', 'Ä'=>'A', 'Å'=>'A', 'Ă'=>'A', 'Ā'=>'A', 'Ą'=>'A', 'Æ'=>'A', 'Ǽ'=>'A',
            'à'=>'a', 'á'=>'a', 'â'=>'a', 'ã'=>'a', 'ä'=>'a', 'å'=>'a', 'ă'=>'a', 'ā'=>'a', 'ą'=>'a', 'æ'=>'a', 'ǽ'=>'a',
    
            'Þ'=>'B', 'þ'=>'b', 'ß'=>'Ss',
    
            'Ç'=>'C', 'Č'=>'C', 'Ć'=>'C', 'Ĉ'=>'C', 'Ċ'=>'C',
            'ç'=>'c', 'č'=>'c', 'ć'=>'c', 'ĉ'=>'c', 'ċ'=>'c',
    
            'Đ'=>'Dj', 'Ď'=>'D',
            'đ'=>'dj', 'ď'=>'d',
    
            'È'=>'E', 'É'=>'E', 'Ê'=>'E', 'Ë'=>'E', 'Ĕ'=>'E', 'Ē'=>'E', 'Ę'=>'E', 'Ė'=>'E',
            'è'=>'e', 'é'=>'e', 'ê'=>'e', 'ë'=>'e', 'ĕ'=>'e', 'ē'=>'e', 'ę'=>'e', 'ė'=>'e',
    
            'Ĝ'=>'G', 'Ğ'=>'G', 'Ġ'=>'G', 'Ģ'=>'G',
            'ĝ'=>'g', 'ğ'=>'g', 'ġ'=>'g', 'ģ'=>'g',
    
            'Ĥ'=>'H', 'Ħ'=>'H',
            'ĥ'=>'h', 'ħ'=>'h',
    
            'Ì'=>'I', 'Í'=>'I', 'Î'=>'I', 'Ï'=>'I', 'İ'=>'I', 'Ĩ'=>'I', 'Ī'=>'I', 'Ĭ'=>'I', 'Į'=>'I',
            'ì'=>'i', 'í'=>'i', 'î'=>'i', 'ï'=>'i', 'į'=>'i', 'ĩ'=>'i', 'ī'=>'i', 'ĭ'=>'i', 'ı'=>'i',
    
            'Ĵ'=>'J',
            'ĵ'=>'j',
    
            'Ķ'=>'K',
            'ķ'=>'k', 'ĸ'=>'k',
    
            'Ĺ'=>'L', 'Ļ'=>'L', 'Ľ'=>'L', 'Ŀ'=>'L', 'Ł'=>'L',
            'ĺ'=>'l', 'ļ'=>'l', 'ľ'=>'l', 'ŀ'=>'l', 'ł'=>'l',
    
            'Ñ'=>'N', 'Ń'=>'N', 'Ň'=>'N', 'Ņ'=>'N', 'Ŋ'=>'N',
            'ñ'=>'n', 'ń'=>'n', 'ň'=>'n', 'ņ'=>'n', 'ŋ'=>'n', 'ŉ'=>'n',
    
            'Ò'=>'O', 'Ó'=>'O', 'Ô'=>'O', 'Õ'=>'O', 'Ö'=>'O', 'Ø'=>'O', 'Ō'=>'O', 'Ŏ'=>'O', 'Ő'=>'O', 'Œ'=>'O',
            'ò'=>'o', 'ó'=>'o', 'ô'=>'o', 'õ'=>'o', 'ö'=>'o', 'ø'=>'o', 'ō'=>'o', 'ŏ'=>'o', 'ő'=>'o', 'œ'=>'o', 'ð'=>'o',
    
            'Ŕ'=>'R', 'Ř'=>'R',
            'ŕ'=>'r', 'ř'=>'r', 'ŗ'=>'r',
    
            'Š'=>'S', 'Ŝ'=>'S', 'Ś'=>'S', 'Ş'=>'S',
            'š'=>'s', 'ŝ'=>'s', 'ś'=>'s', 'ş'=>'s',
    
            'Ŧ'=>'T', 'Ţ'=>'T', 'Ť'=>'T',
            'ŧ'=>'t', 'ţ'=>'t', 'ť'=>'t',
    
            'Ù'=>'U', 'Ú'=>'U', 'Û'=>'U', 'Ü'=>'U', 'Ũ'=>'U', 'Ū'=>'U', 'Ŭ'=>'U', 'Ů'=>'U', 'Ű'=>'U', 'Ų'=>'U',
            'ù'=>'u', 'ú'=>'u', 'û'=>'u', 'ü'=>'u', 'ũ'=>'u', 'ū'=>'u', 'ŭ'=>'u', 'ů'=>'u', 'ű'=>'u', 'ų'=>'u',
    
            'Ŵ'=>'W', 'Ẁ'=>'W', 'Ẃ'=>'W', 'Ẅ'=>'W',
            'ŵ'=>'w', 'ẁ'=>'w', 'ẃ'=>'w', 'ẅ'=>'w',
    
            'Ý'=>'Y', 'Ÿ'=>'Y', 'Ŷ'=>'Y',
            'ý'=>'y', 'ÿ'=>'y', 'ŷ'=>'y',
    
            'Ž'=>'Z', 'Ź'=>'Z', 'Ż'=>'Z',
            'ž'=>'z', 'ź'=>'z', 'ż'=>'z',

            '©'=>' Copyright ', '®'=>' Registered ', '™' =>' Trademark ',

            //Greek
                'α' => 'a',
                'ά' => 'a',
                'β' => 'b',
                'γ' => 'g',
                'δ' => 'd',
                'ε' => 'e',
                'έ' => 'e',
                'ζ' => 'z',
                'η' => 'i',
                'ή' => 'i',
                'θ' => 'th',
                'ι' => 'i',
                'ί' => 'i',
                'κ' => 'k',
                'λ' => 'l',
                'μ' => 'm',
                'ν' => 'n',
                'ξ' => 'ks',
                'ο' => 'o',
                'ό' => 'o',
                'π' => 'p',
                'ρ' => 'r',
                'σ' => 's',
                'ς' => 's',
                'τ' => 't',
                'υ' => 'y',
                'ύ' => 'y',
                'φ' => 'f',
                'χ' => 'x',
                'ψ' => 'ps',
                'ω' => 'o',
                'ώ' => 'o',

                //Turkish
                'ı' => 'i',
                'İ' => 'I',
                'ç' => 'c',
                'Ç' => 'C',
                'ş' => 's',
                'Ş' => 'S',
                'ğ' => 'g',
                'Ğ' => 'G',
                'ö' => 'o',
                'Ö' => 'O',
                'ü' => 'u',
                'Ü' => 'U',

                //Russian
                    'а' => 'a',
                    'б' => 'b',
                    'в' => 'v',
                    'г' => 'g',
                    'д' => 'd',
                    'е' => 'e',
                    'ё' => 'e',
                    'ж' => 'zh',
                    'з' => 'z',
                    'и' => 'i',
                    'й' => 'y',
                    'к' => 'k',
                    'л' => 'l',
                    'м' => 'm',
                    'н' => 'n',
                    'о' => 'o',
                    'п' => 'p',
                    'р' => 'r',
                    'с' => 's',
                    'т' => 't',
                    'у' => 'u',
                    'ф' => 'f',
                    'х' => 'kh',
                    'ц' => 'ts',
                    'ч' => 'ch',
                    'ш' => 'sh',
                    'щ' => 'shch',
                    'ъ' => '',
                    'ы' => 'y',
                    'ь' => '',
                    'э' => 'e',
                    'ю' => 'yu',
                    'я' => 'ya',
                    'Ё' => 'E',
                    'А' => 'A',
                    'Б' => 'B',
                    'В' => 'V',
                    'Г' => 'G',
                    'Д' => 'D',
                    'Е' => 'E',
                    'Ж' => 'Zh',
                    'З' => 'Z',
                    'И' => 'I',
                    'Й' => 'Y',
                    'К' => 'K',
                    'Л' => 'L',
                    'М' => 'M',
                    'Н' => 'N',
                    'О' => 'O',
                    'П' => 'P',
                    'Р' => 'R',
                    'С' => 'S',
                    'Т' => 'T',
                    'У' => 'U',
                    'Ф' => 'F',
                    'Х' => 'Kh',
                    'Ц' => 'Ts',
                    'Ч' => 'Ch',
                    'Ш' => 'Sh',
                    'Щ' => 'Shch',
                    'Ъ' => '',
                    'Ы' => 'Y',
                    'Ь' => '',
                    'Э' => 'E',
                    'Ю' => 'Yu',
                    'Я' => 'Ya',

                    //Ukrainian
                        'а' => 'a',
                        'б' => 'b',
                        'в' => 'v',
                        'г' => 'h',
                        'ґ' => 'g',
                        'д' => 'd',
                        'е' => 'e',
                        'є' => 'ie',
                        'ж' => 'zh',
                        'з' => 'z',
                        'и' => 'y',
                        'і' => 'i',
                        'ї' => 'i',
                        'й' => 'i',
                        'к' => 'k',
                        'л' => 'l',
                        'м' => 'm',
                        'н' => 'n',
                        'о' => 'o',
                        'п' => 'p',
                        'р' => 'r',
                        'с' => 's',
                        'т' => 't',
                        'у' => 'u',
                        'ф' => 'f',
                        'х' => 'kh',
                        'ц' => 'ts',
                        'ч' => 'ch',
                        'ш' => 'sh',
                        'щ' => 'shch',
                        'ь' => '',
                        'ю' => 'iu',
                        'я' => 'ia',
                        'Ґ' => 'G',
                        'Є' => 'Ye',
                        'І' => 'I',
                        'Ї' => 'Yi',
                        'А' => 'A',
                        'Б' => 'B',
                        'В' => 'V',
                        'Г' => 'H',
                        'Д' => 'D',
                        'Е' => 'E',
                        'Ж' => 'Zh',
                        'З' => 'Z',
                        'И' => 'Y',
                        'Й' => 'Y',
                        'К' => 'K',
                        'Л' => 'L',
                        'М' => 'M',
                        'Н' => 'N',
                        'О' => 'O',
                        'П' => 'P',
                        'Р' => 'R',
                        'С' => 'S',
                        'Т' => 'T',
                        'У' => 'U',
                        'Ф' => 'F',
                        'Х' => 'Kh',
                        'Ц' => 'Ts',
                        'Ч' => 'Ch',
                        'Ш' => 'Sh',
                        'Щ' => 'Shch',
                        'Ь' => '',
                        'Ю' => 'Yu',
                        'Я' => 'Ya',

                        //Czech
                            'á' => 'a',
                            'č' => 'c',
                            'ď' => 'd',
                            'é' => 'e',
                            'ě' => 'e',
                            'í' => 'i',
                            'j' => 'j',
                            'k' => 'k',
                            'l' => 'l',
                            'm' => 'm',
                            'n' => 'n',
                            'ň' => 'n',
                            'o' => 'o',
                            'p' => 'p',
                            'q' => 'q',
                            'r' => 'r',
                            'ř' => 'r',
                            's' => 's',
                            'š' => 's',
                            't' => 't',
                            'ť' => 't',
                            'u' => 'u',
                            'ů' => 'u',
                            'ú' => 'u',
                            'v' => 'v',
                            'x' => 'x',
                            'y' => 'y',
                            'ý' => 'y',
                            'z' => 'z',
                            'ž' => 'z',
                            'Á' => 'A',
                            'Č' => 'C',
                            'Ď' => 'D',
                            'É' => 'E',
                            'Ě' => 'E',
                            'Í' => 'I',
                            'J' => 'J',
                            'K' => 'K',
                            'L' => 'L',
                            'M' => 'M',
                            'N' => 'N',
                            'Ň' => 'N',
                            'O' => 'O',
                            'P' => 'P',
                            'Q' => 'Q',
                            'R' => 'R',
                            'Ř' => 'R',
                            'S' => 'S',
                            'Š' => 'S',
                            'T' => 'T',
                            'Ť' => 'T',
                            'U' => 'U',
                            'Ů' => 'U',
                            'Ú' => 'U',
                            'V' => 'V',
                            'X' => 'X',
                            'Y' => 'Y',
                            'Ý' => 'Y',
                            'Z' => 'Z',
                            'Ž' => 'Z',

                        //Polish
                        'ą' => 'a',
                        'ć' => 'c',
                        'ę' => 'e',
                        'ł' => 'l',
                        'ń' => 'n',
                        'ó' => 'o',
                        'ś' => 's',
                        'ź' => 'z',
                        'ż' => 'z',
                        'Ą' => 'A',
                        'Ć' => 'C',
                        'Ę' => 'E',
                        'Ł' => 'L',
                        'Ń' => 'N',
                        'Ó' => 'O',
                        'Ś' => 'S',
                        'Ź' => 'Z',
                        'Ż' => 'Z',

                    //Latvian 
                        'ā' => 'a',
                        'č' => 'c',
                        'ē' => 'e',
                        'ģ' => 'g',
                        'ī' => 'i',
                        'ķ' => 'k',
                        'ļ' => 'l',
                        'ņ' => 'n',
                        'š' => 's',
                        'ū' => 'u',
                        'ž' => 'z',
                        'Ā' => 'A',
                        'Č' => 'C',
                        'Ē' => 'E',
                        'Ģ' => 'G',
                        'Ī' => 'I',
                        'Ķ' => 'K',
                        'Ļ' => 'L',
                        'Ņ' => 'N',
                        'Š' => 'S',
                        'Ū' => 'U',
                        'Ž' => 'Z',
        )
        );
        $str = preg_replace(array_keys($options['replacements']),$options['replacements'],$str);
        if($options['transliterate']) {
            $str = str_replace(array_keys($char_map),$char_map,$str);
        }
        $str = preg_replace('/[^\p{L}\p{Nd}]+/u',$options['delimiter'],$str);
        $str = preg_replace('/('.preg_quote($options['delimiter'],'/').'){2,}/','$1',$str);
        $str = mb_substr($str,0,($options['limit'] ? $options['limit']: mb_strlen($str,'UTF-8')),'UTF-8');
        $str = trim($str,$options['delimiter']);
        return $options['lowercase'] ? mb_strtolower($str,'UTF-8') : $str;
    
}
